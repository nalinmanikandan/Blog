<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<div class="container-fluid">
  <div id="<%= dom_id(post) %>" class="col-md-6">

    <p class="post-title">
      <strong>Title:</strong><%= post.title %>&nbsp;&nbsp;&nbsp;<strong>(<%= post.topic.title %>)</strong>
    </p>

    <% if post.user.present? %>
      <p>
        <strong>User:</strong>
        <%= post.user.email %>
      </p>
    <% end %>

    <div class="image-container">
      <% if post.image.attached? %>
        <%= image_tag(post.image, style: "width: 200px") %>
      <% else %>
        No image available
      <% end %>
    </div>

    <p class="post-content">
      <strong>Content:</strong><%= post.content %>
    </p>
    <p class="tags">
      <strong>Tags:</strong>
      <% post.tags.each do |tag| %>
        <%= link_to tag.name, tag, class: "badge badge-primary mr-2" %>
      <% end %>
    </p>

    <p class="average-rating">
      <strong>Average Rating:</strong>
      <% if post.ratings.any? %>
        <% avg = post.rating_average %>
        <% while avg>0 %>
          <span class="star-rating">&#9733;</span>
          <% avg=avg-1 %>
          <% end %>
        <!--<span class="star-rating">&#9733;</span> <%= post.rating_average %>-->
      <% else %>
        Not rated yet
      <% end %>
    </p>

    <div class="ratings">
      <% (1..5).to_a.reverse.each do |star| %>
        <div class="star-rating">
          <%= star %> Star Ratings:
          <%= post.ratings.where(value: star).count %>
        </div>
      <% end %>
    </div>

    <%= form_for([@topic, post, Rating.new], html: { class: "rating-form" }) do |f| %>
      <div class="form-group">
        <%= f.label "Rate this post:" %>
        <%= f.collection_radio_buttons :value, [[1, '1'], [2, '2'], [3, '3'], [4, '4'], [5, '5']], :first, :last, class: "form-check-input" %>
      </div>
      <div class="form-group">
        <%= f.submit "Submit Rating", class: "btn btn-primary" %>
      </div>
    <% end %>

    <%= form_for([@topic,post,Comment.new]) do |form| %>
      <div class="field">
        <%= form.label :content %>
        <%= form.text_field :body %>
      </div>
      <div class="actions">
        <%= form.submit %>
      </div>
    <% end %>

    <strong>Comments:</strong><br>
    <% @comments.each do |comment| %>
      <strong><%= comment.user.email %></strong>&nbsp;&nbsp;&nbsp;
      <%= comment.body %>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <%= link_to 'View Ratings', topic_post_comment_user_comment_ratings_path(post.topic,post,comment) %>&nbsp;&nbsp;&nbsp;
      <%= render "usercommentrating", topic: post.topic,post: post, comment: comment,usercommentrating: UserCommentRating.new %>

      <% if can? :update, comment %>
        <%= link_to 'Edit', edit_topic_post_comment_path(@topic, @post, comment) %>
      <% end %>
      &nbsp;&nbsp;&nbsp;
      <% if can? :delete, comment %>
        <%= button_to 'Destroy', topic_post_comment_path(@topic, @post, comment), method: :delete %>
      <% end %><br>
    <% end %>

  </div>
</div>
<style>
    /* Custom CSS for centering the content */
    body {
        font-family: Arial, sans-serif;
        background-color: #f8f9fa;
        font-size: 14px; /* Set the default font size to 14px */
    }

    .container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
    }

    /* Style the content */
    #<%= dom_id(post) %> {
        background-color: #fff;
        padding: 20px;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .post-title {
        font-size: 16px; /* Set the font size for the post title */
        font-weight: bold;
    }

    .image-container {
        margin-top: 10px;
    }

    .post-content {
        margin-top: 10px;
    }

    .tags {
        margin-top: 10px;
    }

    .average-rating {
        margin-top: 10px;
    }

    .rating-form {
        margin-top: 10px;
    }

    /* Style the form elements */
    .field {
        margin-top: 10px;
    }

    /* Style the submit button */
    .actions {
        margin-top: 10px;
    }

    /* Custom CSS for star rating */
    .star-rating {
        color: #f39c12; /* Star color */
    }

</style>